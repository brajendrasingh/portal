<div class="dashboard-wrapper">
    <h2>Assessment Results Dashboard</h2>
    <div class="table-controls">
        <div>
            <label>Show</label>
            <select [(ngModel)]="pageSize" (change)="changePageSize(pageSize)">
                <option *ngFor="let size of pageSizeOptions" [value]="size">
                    {{ size }}
                </option>
            </select>
            <label>entries</label>
        </div>
    
        <div>
            Total Records: {{ totalElements }}
        </div>
    </div>
    <table class="result-table">
        <thead>
            <tr>
                <th>Sl. No</th>
                <th>User</th>
                <th>Assessment</th>
                <th>Attempt</th>
                <th>Total Questions</th>
                <th>Score</th>
                <th>Status</th>
                <th>Attempted On</th>
                <th>Action</th>
            </tr>
        </thead>

        <tbody>
            <tr *ngFor="let r of results; let i = index">
                <td>{{ currentPage * pageSize + i + 1 }}</td>
                <td>{{ r.userId }}</td>
                <td>{{ r.assessmentId }}</td>
                <td>{{ r.attemptNo }}</td>
                <td>{{ r.totalQuestions }}</td>
                <td>{{ (r.score / r.totalQuestions * 100) | number:'1.0-0' }}%</td>
                <td>
                    <span class="badge" [ngClass]="r.status === 'PASS' ? 'pass' : 'fail'"> {{ r.status }} </span>
                </td>
                <td>{{ r.submittedAt | date:'dd MMM yyyy, hh:mm a' }}</td>
                <td>
                    <button class="btn-view" [routerLink]="['/result', r.userId, r.assessmentId, r.attemptNo]"> View
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="pagination">
        <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 0"> Previous </button>

        <span> Page {{ currentPage + 1 }} of {{ totalPages }} </span>

        <button (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages - 1"> Next </button>
    </div>
</div>