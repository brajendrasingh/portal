<div class="result-wrapper" *ngIf="questions?.length">

  <div class="result-card">

    <!-- Header -->
    <div class="header">
      <h2>Assessment Result</h2>
      <span class="status-badge" [ngClass]="resultStatus === 'PASS' ? 'pass' : 'fail'">
        {{ resultStatus }}
      </span>
    </div>

    <!-- Summary -->
    <div class="summary-grid">
      <div class="summary-item">
        <label>Total Questions</label>
        <p>{{ totalQuestions }}</p>
      </div>

      <div class="summary-item">
        <label>Correct Answers</label>
        <p>{{ correctAnswers }}</p>
      </div>

      <div class="summary-item">
        <label>Score</label>
        <p>{{ scorePercentage }}%</p>
      </div>

      <div class="summary-item">
        <label>Passing Criteria</label>
        <p>{{ passingPercentage }}%</p>
      </div>
    </div>
    <div class="table-controls">
      <div>
        <label>Show</label>
        <select [(ngModel)]="pageSize" (change)="changePageSize(pageSize)">
          <option *ngFor="let size of pageSizeOptions" [value]="size">
            {{ size }}
          </option>
        </select>
        <label>questions per page</label>
      </div>

      <div>
        Total Questions: {{ questions?.length }}
      </div>
    </div>
    <!-- Question Review -->
    <section class="result-panel">
      <h3 class="review-title">Question Review</h3>

      <div class="review-card" *ngFor="let q of paginatedQuestions; let i = index">

        <p class="review-question"> {{ currentPage * pageSize + i + 1 }}. {{ q.questionText }} </p>

        <p class="review-answer">
          <strong>Your Answer:</strong>
          <span [ngClass]="isCorrect(q) ? 'correct' : 'wrong'">
            {{ q.selectedAnswers && q.selectedAnswers.length ?q.selectedAnswers : 'Not Answered' }} </span>
        </p>

        <p class="review-correct" *ngIf="!isCorrect(q)">
          <strong>Correct Answer:</strong> {{ q.correctAnswers }}
        </p>

      </div>
    </section>
    <div class="pagination" *ngIf="totalPages > 1">

      <button (click)="changePage(0)" [disabled]="currentPage === 0">
        ⏮ First
      </button>

      <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 0">
        ⬅ Previous
      </button>

      <span>
        Page {{ currentPage + 1 }} of {{ totalPages }}
      </span>

      <button (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages - 1">
        Next ➡
      </button>

      <button (click)="changePage(totalPages - 1)" [disabled]="currentPage === totalPages - 1">
        Last ⏭
      </button>

    </div>
    <!-- Footer Actions -->
    <div class="footer">
      <button class="btn-primary" routerLink="/dashboard">
        Go to Dashboard
      </button>
      <button class="btn-secondary" routerLink="/resultsDashboard">
        Results Dashboard
      </button>
      <button class="btn-secondary" routerLink="/assessment">
        Retake Assessment
      </button>
    </div>

  </div>
</div>